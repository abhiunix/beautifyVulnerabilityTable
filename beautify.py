#!/usr/bin/python3
import os
import string
from colorit import *

#Author: Abhijeet Singh (@abhiunix)

init_colorit()
High = 0
Medium = 0
Low=0
count=0


dict_all = {'Injection': 'High',
			'Broken Authentication': 'High',
			'Sensitive Data Exposure': 'Medium',
			'XML External Entities (XXE)': 'High',
			'Broken Access Control': 'High',
			'Security Misconfiguration': 'Medium',
			'Cross-Site Scripting': 'High',
			'Insecure Deserialization': 'High',
			'Using Components with Known Vulnerabilities': 'Low',
			'Insufficient Logging & Monitoring': 'Medium',
			'Malicious File Upload': 'High',
			'Email-Flooding': 'Low',
			'Email-Harvesting': 'Low',
			'ClickJacking': 'Low', }

dict_final={}

#Raw text
file_ = open('vulnerabilities.txt', 'r')
rawData =file_.read()
file_.close()

rawData = rawData.replace(', ', '\n')
rawData = rawData.replace(' and ', '\n')


beautified = open('Beautify.txt','w')
beautified.write(rawData)
beautified.close()

beautified = open('Beautify.txt','r')

while True: 
    count += 1
  
    # Get next line from file 
    line = beautified.readline().strip() 

    for key in dict_all:
    	if key==line:
    		dict_final[key]=dict_all[key]

    # if line is empty 
    # end of file is reached 
    if not line: 
        break
beautified.close()

for key in dict_final:
    if dict_final[key]=='High':
    	High+=1
    elif dict_final[key]=='Medium':
    	Medium+=1
    else:
    	Low+=1


print(color("Vulnerabilities are:", Colors.red))
print(color("{:<49} {}".format('Vulnerability Name', ' Severity'), Colors.white))
for key, value in dict_final.items(): 
    vuln, severity = key, value 
    print ("{:<50} {}".format(vuln, severity)) 

print(color("\nHigh:   "+str(High), Colors.red))
print(color("Medium: "+str(Medium), Colors.yellow))
print(color("Low:    "+str(Low), Colors.green))
Total= High+Medium+Low

print(color("\nTotal:  "+str(Total), Colors.blue))
os.system("rm -r Beautify.txt")

